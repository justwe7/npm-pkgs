<template>
  <div @click="handleTriggerVConsole">
    <svg t="1662450259109" class="icon" viewBox="0 0 1026 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2529" width="30" height="30"><path d="M384.216363 59.877205c19.260501 0 34.92837 15.667869 34.928369 34.92837v289.40649c0 19.260501-15.667869 34.92837-34.928369 34.92837h-289.406491c-19.260501 0-34.92837-15.667869-34.928369-34.92837v-289.40649c0-19.260501 15.667869-34.92837 34.928369-34.92837h289.406491m0-59.877205h-289.406491c-52.392554 0-94.805575 42.41302-94.805574 94.805575v289.40649c0 52.392554 42.41302 94.805575 94.805574 94.805575h289.406491c52.392554 0 94.805575-42.41302 94.805574-94.805575v-289.40649c0-52.392554-42.41302-94.805575-94.805574-94.805575zM386.312065 604.859565c19.260501 0 34.92837 15.667869 34.92837 34.92837v289.40649c0 19.260501-15.667869 34.92837-34.92837 34.92837H96.905575c-19.260501 0-34.92837-15.667869-34.92837-34.92837V639.787935c0-19.260501 15.667869-34.92837 34.92837-34.92837h289.40649m0-59.877205H96.905575c-52.392554 0-94.805575 42.41302-94.805575 94.805575v289.40649c0 52.392554 42.41302 94.805575 94.805575 94.805575h289.40649c52.392554 0 94.805575-42.41302 94.805575-94.805575V639.787935c0-52.392554-42.41302-94.805575-94.805575-94.805575zM929.198723 604.859565c19.260501 0 34.92837 15.667869 34.92837 34.92837v289.40649c0 19.260501-15.667869 34.92837-34.92837 34.92837H639.792233c-19.260501 0-34.92837-15.667869-34.92837-34.92837V639.787935c0-19.260501 15.667869-34.92837 34.92837-34.92837h289.40649m0-59.877205H639.792233c-52.392554 0-94.805575 42.41302-94.805575 94.805575v289.40649c0 52.392554 42.41302 94.805575 94.805575 94.805575h289.40649c52.392554 0 94.805575-42.41302 94.805575-94.805575V639.787935c0-52.392554-42.41302-94.805575-94.805575-94.805575zM692.184787 200.788227c4.590586 8.283013 13.07319 13.372576 22.254361 13.172985l25.846994-0.598772c-0.299386 67.561446-7.085469 148.794854-125.742131 218.95098l-1.397134 0.798362-1.097749 1.097749c-4.790176 4.889972-6.386902 11.57626-3.892019 17.56398 2.594679 6.087516 9.081376 10.07933 16.06705 9.979535h0.997954l0.997953-0.199591c58.579866-10.179125 108.976513-27.8429 150.191989-52.791736 34.628984-20.957022 62.970861-47.103401 84.127473-77.740571 33.132053-47.801969 41.315271-94.805575 43.011793-121.051749l29.539421-0.598772c11.077283-0.199591 20.757431-5.887925 25.747198-15.168892 4.790176-8.981581 4.191404-19.759478-1.596726-28.142287l-0.299386-0.498976L856.64751 31.535328c-7.28506-9.280967-18.362343-14.470325-30.537375-14.270734-7.983627 0.199591-15.468278 2.594679-21.755384 6.985674-3.293246 2.295293-6.386902 5.189358-8.981581 8.582399L693.781513 171.149011l-0.199591 0.498977c-5.887925 8.881785-6.486697 20.058864-1.397135 29.140239z" p-id="2530" fill="#ffffff"></path><path d="M623.725183 462.252022c-7.085469 0-13.472371-4.091609-16.06705-10.27892-2.494884-5.98772-0.997953-12.973394 3.991813-18.062957l1.197544-1.197544 1.397135-0.798363c114.864438-67.960628 125.143358-144.902836 125.442745-218.052821l-25.348017 0.598772c-9.181171 0.199591-17.963161-4.989767-22.653543-13.372576-5.089562-9.181171-4.590586-20.657636 1.397135-29.739011l0.199591-0.399182L794.973989 32.533281c2.494884-3.293246 5.588539-6.187311 9.081376-8.682194 6.386902-4.49079 14.071143-6.885879 22.05477-7.08547 12.274827-0.199591 23.551701 5.089562 30.936556 14.470325l100.294319 133.925348 0.299386 0.498977c5.887925 8.582399 6.486697 19.559887 1.596725 28.641263-5.189358 9.480557-14.969301 15.268687-26.146379 15.368483l-29.040445 0.598772c-1.696521 24.549654-9.480557 72.551213-43.011792 120.852158-21.256408 30.736965-49.598285 56.883345-84.327064 77.840367-41.215476 24.948835-91.811714 42.712406-150.391579 52.891531l-0.997954 0.199591h-1.097749c-0.199591 0.199591-0.299386 0.199591-0.498976 0.19959z m-10.27892-28.641263l-1.097749 1.097749c-4.690381 4.790176-6.187311 11.276874-3.792223 16.965208 2.494884 5.887925 8.78199 9.779943 15.568073 9.680148h0.997954l0.898158-0.199591c58.48007-10.07933 108.976513-27.8429 150.092193-52.69194 34.529188-20.857226 62.77127-47.003606 84.027678-77.640776 33.63103-48.500536 41.315271-96.502095 42.911997-120.852158v-0.498977l29.938602-0.598772c10.877692-0.099795 20.35825-5.688334 25.348017-14.869506 4.690381-8.78199 4.091609-19.360296-1.596725-27.64331l-0.299386-0.498976L856.248329 31.834714c-7.185265-9.181171-18.162752-14.270734-30.138194-14.071143-7.784037 0.199591-15.168892 2.494884-21.455998 6.885878-3.492837 2.395088-6.386902 5.289153-8.881785 8.482604L694.180694 171.448397l-0.199591 0.399181c-5.78813 8.881785-6.287107 19.859273-1.397135 28.741059 4.590586 8.183218 12.873599 13.07319 21.755385 12.873599l26.34597-0.598772v0.498976c-0.199591 32.633077-1.696521 70.655102-18.561933 108.776923-18.961115 42.911997-54.089075 79.137706-107.479583 110.673033l-1.197544 0.798363z" p-id="2531" fill="#ffffff"></path></svg>
    <p class="text-center f-fz-14">vconsole</p>
  </div>
</template>
<script type="text/ecmascript-6" lang="ts">
import Cookies from 'js-cookie'
import { Toast } from 'vant'

export default {
  inject: ['$opt'],
  data () {
    return {
      isDebug: false,
      oVConsole: null
    }
  },
  created () {},
  mounted () {
    if (Cookies.get('vc') || this.$opt?.vconsole) {
      this.loadVConsole()
      this.isDebug = true
    }
  },
  computed: {},
  methods: {
    handleTriggerVConsole () {
      this.isDebug = !this.isDebug
      if (this.isDebug) {
        Cookies.set('vc', 1)
        this.loadVConsole()
        return
      }
      Cookies.remove('vc')
      this.oVConsole && this.oVConsole.destroy()
    },
    loadVConsole () {
      return new Promise(resolve => {
        if (window.VConsole) {
          this.oVConsole = new window.VConsole()
          return
        }
        const script = document.createElement('script')
        !this.$opt?.vconsole && Toast.loading()
        script.setAttribute('src', '//unpkg.com/vconsole@latest/dist/vconsole.min.js')
        script.setAttribute('charset', 'UTF-8')
        document.querySelector('html').appendChild(script)
        script.onload = () => {
          // eslint-disable-next-line no-new
          this.oVConsole = new window.VConsole()
          Toast('vconsole注入成功')
        }
      })
    }
  }
}
</script>
